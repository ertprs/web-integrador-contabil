<div class="mt-2 mb-4" *ngIf="tabIsClicked">
  <app-info [description]="info.info"></app-info>
</div>

<form autocomplete="off">
  <div class="card">
    <mat-progress-bar [value]="percentage" class="progress-bar"  [matTooltip]="percentage + '%'"></mat-progress-bar>
    <mat-tab-group mat-align-tabs="center" (selectedTabChange)="onTab($event, false)">
      <mat-tab label="Pagamentos"></mat-tab>
      <mat-tab label="Extrato Débitos"></mat-tab>
      <mat-tab label="Recebimentos"></mat-tab>
      <mat-tab label="Extrato Créditos"></mat-tab>
    </mat-tab-group>


    <div class="p-5 pt-0">
      <div class="row m-0 w-100">
        <app-text class="col">Total de lançamentos: {{ total }}</app-text>
      </div>
      <div class="row m-0 w-100 mb-4">
        <div class="col" *ngIf="impact > 0">
          <app-text class="mt-3">Impacto: </app-text>
          <app-text class="ml-1 cursor-pointer"(click)="openGrid()" color="danger" [matTooltip]="info.affecteds" bold="true" >{{ impact }}</app-text>
          <app-text class="ml-1"(click)="openGrid()"> lançamentos.</app-text>
          <app-icon class="ml-2" src="question-circle" [matTooltip]="info.affectedsOrientation"></app-icon>
        </div>

      </div>
      <app-card *ngIf="records && (records[0] || isFetching)">
        <app-card>
          <app-card main="true">

            <div *ngIf="isFetching && !records?.length"><br><br><br><br><br><br><br><br></div>

            <div
              class="row m-0 mb-2"
              *ngIf="records[0]?.descricao || records[0]?.portador"
            >
              <app-chips-group
                *ngIf="records[0]?.descricao && rebuild !== 1"
                [config]="descricao()"
                (clicked)="onDevolve($event)"
                class="col"
              ></app-chips-group>
              <app-chips-group
                *ngIf="records[0]?.portador && rebuild !== 2"
                [config]="portador()"
                (clicked)="onDevolve($event)"
                class="col"
              ></app-chips-group>
            </div>

            <div
              class="row m-0 mb-2"
              *ngIf="
                (records[0]?.dataMovimento ||
                records[0]?.valorOriginal ||
                records[0]?.documento) "
            >
              <app-chips-group
                *ngIf="records[0]?.dataMovimento && rebuild !== 3"
                [config]="dataMovimento()"
                (clicked)="onDevolve($event)"
                class="col"
              ></app-chips-group>
              <app-chips-group
                *ngIf="records[0]?.valorOriginal && rebuild !== 4"
                [config]="valorOriginal()"
                (clicked)="onDevolve($event)"
                class="col"
              ></app-chips-group>
              <app-chips-group
                *ngIf="records[0]?.documento && rebuild !== 5"
                [config]="documento()"
                (clicked)="onDevolve($event)"
                class="col"
              ></app-chips-group>
            </div>

            <div class="row m-0 mb-2" *ngIf="hasComplements && tipo == 'MOVIMENTO' && rebuild !== 6">
              <app-chips-group
                *ngIf="hasComplements"
                [config]="complementos()"
                (clicked)="onDevolve($event)"
                class="col"
              ></app-chips-group>
            </div>

            <div class="row m-0 mb-2" *ngIf="records[0]?.complemento02 && records[0]?.arquivo.labelComplemento02 && records[0]?.complemento02.length > 1 && tipo == 'EXTRATO' && rebuild !== 7">
              <app-chips-group
                [config]="complemento02()"
                (clicked)="onDevolve($event)"
                class="col"
              ></app-chips-group>
            </div>

          </app-card>
        </app-card>
      </app-card>

      <div class="row mt-4 ml-3 d-block">
        <app-comment type="danger" *ngIf="errorText">{{ errorText }}</app-comment>
        <app-comment type="danger" *ngIf="errorText2">{{ errorText2 }}</app-comment>
      </div>

      <div
        class="row m-0"
        *ngIf="records && records.length"
      >
        <div class="form-group col-md-5 col-lg-5 col-xl-5 mt-1">
          <app-input [control]="account" [matTooltip]="info.account" label="Conta"></app-input>
        </div>

        <div class="col-md-7 col-lg-7 col-xl-7">
          <div class="row w-100 action-set">
            <input
              type="button"
              class="btn btn-primary col mx-2"
              (click)="regra()"
              value="Regra"
              [matTooltip]="info.rule"
            />
            <input
              type="button"
              class="btn btn-primary col mx-2"
              [value]="buttonLabel"
              (click)="fornecedor()"
              [matTooltip]="info.provider"
            />
            <input
              *ngIf="conditions.verify()"
              type="button"
              class="btn btn-outline-primary col mx-2"
              value="Ignorar"
              (click)="ignorar()"
              [matTooltip]="info.ignore"
            />
            <div class="button-area col mx-2">
              <div class="row w-100 m-0">

                <button [disabled]="!pageInfo.hasPrevious" class="btn btn-outline-info col" (click)="navigate('previous')" matTooltip="Lançamento anterior">
                  <i class="fad fa-chevron-double-left"></i>
                </button>
                <button [disabled]="!pageInfo.hasNext" class="btn btn-outline-info col" (click)="navigate('next')" matTooltip="Próximo lançamento">
                  <i class="fad fa-chevron-double-right"></i>
                </button>

              </div>
            </div>
            <input
              *ngIf="currentUser.type === 0"
              type="button"
              class="btn btn-outline-danger col mx-2"
              value="Excluir"
              (click)="delete()"
              matTooltip="Remover todos os lançamentos do arquivo atual"
            />
          </div>
        </div>
      </div>
    </div>
    <!-- </form> -->
  </div>
</form>
